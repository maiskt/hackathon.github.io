---
title: "IFG - Section 9"
author: "MD Shuey"
output: html_document
---
``` {r setup, eval=F, echo=F}
library(knitr)
knitr::opts_chunk$set(echo = TRUE)
library(haven)
library(readxl)
library(dplyr)
library(codebook)
ng16 <- read_sav("//ARCHIVE/Works_In_Progress/GATES FII PROJECT FOLDERS/GATES FII WAVES 4 - 6 2016-2019/Final Data/In house/FII Nigeria 2016 (in house).sav")
VL <- read_excel("Variable list_04182019.xlsx")
vl_table <- table(VL[,1])%>%data.frame
colnames(vl_table) <- c("Section", "Count")
cb_ng16 <- codebook_table(ng16)[,-c(10:19)]
```

## Informal Financial Groups
----

The following variables were coded in numeric order of which they were asked.

### IFG1

A derived binary variable, IFG1 represents the respondent's belonging to an informal financial group. The definition varies by sophistication of village-level services, but the common institutions that qualify include:

* Cooperatives
* Village-level saving and lending group
* Informal loan clubs or rotating savings and credit associations (ROSCAs, with [many regional names](http://www.gdrc.org/icm/rosca/rosca-names.html))

### IFG2
### IFG3
```{r IFG3, eval=F, echo=F}
#
grep("IFI20",colnames(ng16))
#
w_ifi1 <- cb_ng16$label[grep("IFI1_", cb_ng16$name)]
# 2, 3, 6, and 7 apply to IFG1
grep("IFI1_", cb_ng16$name)
ng16$IFG1 <- apply(ng16[,c(1040, 1044, 1054, 1056)], 1, function(x) ifelse(any(x == 1), 1, 0))
#
y <- names(attr(ng16$IFI21, "labels"))
#verifying the labels are correct
w_ifi20 <- grep("IFI20",cb_ng16$name)
ifi20 <- cb_ng16$label[w_ifi20]
ifi20 <- strsplit(ifi20, "\\? ")%>% unlist
ifi20 <- ifi20[c(2,4,6,8,10,12,14,16)]
# IFI20 is identical
colnames(ng16[,grep("IFI20",colnames(ng16))]) <- sprintf("IFG3_[%s]", seq(1:8))
```

### IFG4

#### Nigeria
Nigeria 2016 only asked which reason for informal group financing was most important
out of a list of 15, with an "other" option to describe.
If their response was one of the four, it was categorized as a "5" (most important)
```{r IFG4, eval=F, echo=F}
# in its column.
ng16$IFG4_1 <- NA
ng16$IFG4_2 <- NA
ng16$IFG4_3 <- NA
ng16$IFG4_4 <- NA

for (i in 1:nrow(ng16)){
  z <- ng16$IFI21[i]
 if (is.na(z)) {ng16$IFG4_1[i] <- NA}
  else if (z == 1) {ng16$IFG4_1[i] <- 5}
  else if (z == 4) {ng16$IFG4_2[i] <- 5}
  else if (z == 3) {ng16$IFG4_3[i] <- 5}
  else if (z == 12) {ng16$IFG4_4[i] <- 5}
}
```
### Appendix
```{r all-code, ref.label=knitr::all_labels(), echo = TRUE, eval = FALSE}
```